<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Services & Products Shop | Al-Khat Al-Mudi</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="icon" type="image/svg+xml" href="images/favicon.svg">

    <style>
        /* TACTICAL BACKGROUND (Matches Profile/Index) */
        .shop-page {
            background-color: #0b1426; 
            background-image: 
                linear-gradient(rgba(11, 20, 38, 0.9), rgba(11, 20, 38, 0.9)),
                url('https://upload.wikimedia.org/wikipedia/commons/8/80/World_map_-_low_resolution.svg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding-top: 100px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .shop-container { flex: 1; padding: 40px 0; }
        
        .shop-header-text { text-align: center; margin-bottom: 50px; }
        .shop-header-text h2 { color: var(--brand-cyan); font-size: 2.5rem; margin-bottom: 10px; font-family: var(--font-primary); }
        .shop-header-text p { color: rgba(255,255,255,0.7); max-width: 600px; margin: 0 auto; line-height: 1.6; }

        /* PRODUCT GRID */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        /* GLASS PRODUCT CARDS */
        .product-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            transition: transform 0.3s ease, border-color 0.3s ease;
            display: flex; flex-direction: column;
        }
        
        .product-card:hover {
            transform: translateY(-10px);
            border-color: var(--brand-cyan);
            background: rgba(0, 242, 255, 0.02);
        }

        .product-icon {
            font-size: 3.5rem;
            color: var(--brand-magenta);
            margin-bottom: 20px;
            filter: drop-shadow(0 0 10px rgba(255, 0, 255, 0.3));
        }

        .product-title { font-family: var(--font-primary); font-size: 1.4rem; margin-bottom: 15px; color: white; }
        .product-desc { font-size: 0.9rem; color: rgba(255,255,255,0.6); margin-bottom: 25px; flex-grow: 1; line-height: 1.6; }
        
        .product-price {
            font-size: 2rem; font-weight: 900; color: var(--brand-cyan);
            margin-bottom: 25px; font-family: var(--font-primary);
        }

        .btn-order {
            background: transparent; border: 2px solid var(--brand-cyan); color: var(--brand-cyan);
            padding: 12px 25px; border-radius: 30px; font-weight: bold; cursor: pointer; transition: 0.3s;
            text-transform: uppercase; letter-spacing: 1px; width: 100%;
        }
        .btn-order:hover { background: var(--brand-cyan); color: #0b1426; box-shadow: 0 0 20px rgba(0, 242, 255, 0.4); }

    </style>
</head>
<body class="shop-page">

    <header>
        <div class="container">
            <nav class="navbar">
                <a href="index.html" class="logo-box" style="text-decoration: none;">
                    <div class="dna-logo">
                        <div class="dna-drop dna-magenta"></div>
                        <div class="dna-drop dna-cyan"></div>
                    </div>
                    <div class="brand-text">
                        <h3>Al-Khat Al-Mudi</h3>
                        <span id="header-brand_sub">TRANSLATION SERVICES</span>
                    </div>
                </a>
                
                <div id="user-profile-section" class="user-status-hidden">
                    <a href="profile.html" class="user-orb">
                        <i class="fas fa-user-circle"></i>
                        <span id="user-display-name">Client</span>
                    </a>
                    <button onclick="handleLogout()" class="logout-link">Logout</button>
                </div>
                
                <a href="#menu" class="menu-toggle" id="menuToggle">
                    <span class="text" id="header-menu_btn">MENU</span>
                    <div class="hamburger">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </a>
            </nav>
        </div>
    </header>

    <main class="shop-container container">
        <div class="shop-header-text">
            <h2><i class="fas fa-store"></i> Service Emporium</h2>
            <p>Enhance your translation requests with our premium add-on services. Secure, fast, and globally recognized.</p>
        </div>

        <div class="shop-grid" id="dynamic-product-grid">
            <div style="text-align: center; color: rgba(255,255,255,0.6); grid-column: 1 / -1; padding: 50px;">
                <i class="fas fa-circle-notch fa-spin" style="font-size: 2rem; margin-bottom: 15px;"></i>
                <p>Loading premium services...</p>
            </div>
        </div>
    </main>

    <footer id="contact">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-about">
                    <div class="dna-logo" style="margin-bottom: 20px;">
                        <div class="dna-drop dna-magenta"></div>
                        <div class="dna-drop dna-cyan"></div>
                    </div>
                    <h3 class="arabic-text">الخط المضيء للترجمة</h3>
                    <p id="footer-about_text" style="opacity: 0.7; line-height: 1.6; margin-bottom: 25px;">
                        Your partner in overcoming language barriers. We provide quality, speed, and reliability for all your translation needs.
                    </p>
                     <div class="social-icons">
                        <a href="https://www.facebook.com/share/1Gtg7R2phb/" class="social-icon facebook" title="Facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://instagram.com/alkhatalmudi" class="social-icon instagram" title="Instagram"><i class="fab fa-instagram"></i></a>
                        <a href="https://wa.me/message/BFW6NB4D4ZLLL1" class="social-icon whatsapp" title="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                        <a href="#" class="social-icon linkedin" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>

                <div class="footer-col">
                    <h4 id="footer-col_links">Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="index.html" id="menu-home-footer">Home</a></li>
                        <li><a href="about.html" id="menu-about-footer">About Us</a></li>
                        <li><a href="services.html" id="menu-services-footer">Services</a></li>
                        <li><a href="reservation.html" id="menu-quote-footer">Get a Quote</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4 id="footer-col_legal">Legal</h4>
                    <ul class="footer-links">
                        <li><a href="#" id="footer-privacy">Privacy Policy</a></li>
                        <li><a href="#" id="footer-terms">Terms of Service</a></li>
                        <li><a href="#">Confidentiality</a></li>
                    </ul>
                </div>

                <div class="footer-col">
                    <h4 id="footer-col_contact">Contact Us</h4>
                    <ul class="contact-info">
                        <li>
                            <i class="fas fa-map-marker-alt"></i>
                            <span>Marka Al-Shamaliya, Nadi Al-Sibaq<br>Amran Mall, 3rd Floor, Office 15</span>
                        </li>
                        <li>
                            <i class="fas fa-phone-alt"></i>
                            <span>078-077-0085</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <span>alkhatalmudi@gmail.com</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="copyright">
            <p id="footer-copyright">&copy; 2026 Al-Khat Al-Mudi Translation. All rights reserved.</p>
        </div>
    </footer>

    <div id="side-menu" class="menu-panel">
        <a href="javascript:void(0)" class="close-btn" id="closeMenu">&times;</a>
        <div class="menu-content">
            <h4 class="menu-label" id="menu-label_nav">NAVIGATION</h4>
            <ul class="main-links">
                <li><a href="index.html" id="menu-home">Home</a></li>
                <li class="dropdown-trigger">
                    <a href="javascript:void(0)"><span id="menu-pages">Pages</span> <i class="fas fa-chevron-down"></i></a>
                    <ul class="dropdown-list">
                        <li><a href="about.html" id="menu-about">About Us</a></li>
                        <li><a href="services.html" id="menu-services">Services</a></li>
                        <li><a href="translation.html" id="menu-translation">Translation Info</a></li>
                        <li><a href="packages.html" id="menu-packages">Packages & Pricing</a></li>
                        <li><a href="shop.html" id="menu-shop">Shop / Products</a></li>
                        <li><a href="reservation.html" id="menu-reservation">Book Reservation</a></li>
                        <li><a href="contacts.html" id="menu-contact">Contact Us</a></li>
                    </ul>
                </li>
            </ul>

            <h4 class="menu-label" id="menu-label_member">MEMBER AREA</h4>
            <div class="auth-buttons">
                <a href="login.html" class="btn-auth login" id="menu-login">Log In</a>
                <a href="signup.html" class="btn-auth signup" id="menu-signup">Sign Up</a>
            </div>

            <h4 class="menu-label" id="menu-label_region">REGION SELECT</h4>
            <div class="lang-grid">
                <a href="javascript:void(0)" onclick="switchLanguage('en')" class="lang-orb" title="English"><img src="images/GB.png" alt="English"></a>
                <a href="javascript:void(0)" onclick="switchLanguage('ar')" class="lang-orb" title="Arabic"><img src="images/Ar.png" alt="Arabic"></a>
                <a href="javascript:void(0)" onclick="switchLanguage('du')" class="lang-orb" title="Dutch"><img src="images/Du.png" alt="Dutch"></a>
                <a href="javascript:void(0)" onclick="switchLanguage('ru')" class="lang-orb" title="Russian"><img src="images/Ru.png" alt="Russian"></a>
            </div>
        </div>
    </div>
    
    <script src="assets/js/main.js"></script>
    <script src="assets/js/lang-engine.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDT5mqFBwSBea1_5RMXv3_59V4Y5LUy5to",
            authDomain: "al-khat-backend.firebaseapp.com",
            projectId: "al-khat-backend",
            storageBucket: "al-khat-storage-doha",
            messagingSenderId: "310033181926",
            appId: "1:310033181926:web:9a028807fa7c7ab31c5f27"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app); // Initialize Firestore here

        // 1. AUTH CHECK FOR HEADER
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('user-profile-section').classList.remove('user-status-hidden');
                document.getElementById('user-display-name').innerText = user.displayName || "Client";
                document.querySelector('.auth-buttons').style.display = 'none'; 
            }
        });

        // 2. DYNAMICALLY LOAD PRODUCTS FROM FIREBASE
        async function loadShopInventory() {
            const grid = document.getElementById('dynamic-product-grid');
            try {
                const q = query(collection(db, "shop_inventory"), orderBy("timestamp", "desc"));
                const snapshot = await getDocs(q);
                
                grid.innerHTML = ""; // Clear loader
                
                if(snapshot.empty) {
                    grid.innerHTML = `<div style="text-align:center; color:#aaa; grid-column: 1/-1;">Check back soon for new services!</div>`;
                    return;
                }

                // Alternate colors for a cool UI effect
                const colors = ["var(--brand-magenta)", "var(--brand-cyan)", "#ffc107", "#00ff88"];
                let colorIndex = 0;

                snapshot.forEach(docSnap => {
                    const data = docSnap.data();
                    const iconColor = colors[colorIndex % colors.length];
                    const priceFormatted = parseFloat(data.price).toFixed(2);
                    
                    grid.innerHTML += `
                        <div class="product-card">
                            <i class="${data.icon} product-icon" style="color: ${iconColor}; filter: drop-shadow(0 0 10px ${iconColor}40);"></i>
                            <h3 class="product-title">${data.title}</h3>
                            <p class="product-desc">${data.description}</p>
                            <div class="product-price">${priceFormatted} JOD</div>
                            <button class="btn-order" onclick="purchaseItem('${data.title.replace(/'/g, "\\'")}', '${priceFormatted}')">Order Now</button>
                        </div>
                    `;
                    colorIndex++;
                });

            } catch (error) {
                console.error("Store Error:", error);
                grid.innerHTML = `<div style="color:#ff4b5c; text-align:center; grid-column:1/-1;">Error establishing secure link to inventory databanks.</div>`;
            }
        }

        // Initialize Shop
        loadShopInventory();

        // 3. CHECKOUT PIPELINE HOOK
        window.purchaseItem = function(productName, price) {
            if (!auth.currentUser) {
                alert("Please log in or create an account to purchase shop items.");
                window.location.href = "login.html";
                return;
            }

            const params = new URLSearchParams({
                loc: "Online Shop",
                from: "N/A",
                to: "N/A",
                doc: productName,
                pages: "1",
                urgency: "Standard",
                price: price + " JOD"
            });

            window.location.href = 'checkout.html?' + params.toString();
        }

        window.handleLogout = function() { signOut(auth).then(() => { window.location.reload(); }); }
    </script>
</body>
</html>